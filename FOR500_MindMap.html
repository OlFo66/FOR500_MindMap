<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.2/dist/style.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.8.5/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.17.2/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.17.2/dist/index.js"></script><script>(r => {
                setTimeout(r);
              })(() => {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"Windows Forensics 2/2","children":[{"content":"Registry Forensics","children":[{"content":"Registry Essentials","children":[{"content":"System Hives","children":[{"content":"Info","children":[{"content":"Files storing vital configuration data for the system.<br>\nKeeps configuration data on the OS, installed applications, installed hardware &amp; user accounts.<br>\nRegistry hives are loaded into memory up system boot and user login.","children":[],"payload":{"lines":"4,7"}},{"content":"MRUList (Most Recently Used) from SOFTWARE hive, list last opened document by different software (Word, Wireshark, etc.)","children":[],"payload":{"lines":"7,8"}},{"content":"Similar to FS, registry hives have unallocated space. It may help to identify deleted items by antiforensic tools and,<br>\nuntil it is eventually overwritten, can be recovered.","children":[],"payload":{"lines":"8,10"}},{"content":"Transaction logs files (&lt;HIVENAME&gt;.LOG1 &amp; &lt;HIVENAME&gt;.LOG2) can contain information not yet committed to the registry hives.<br>\nIt is important to take them into account when investigating the Registry.","children":[],"payload":{"lines":"10,12"}}],"payload":{"lines":"3,4"}},{"content":"Hunting","children":[{"content":"In  %Windir%\\System32\\Config:<br>\n_ SAM: local account information including users &amp; groups<br>\n_ SECURITY: System security information such as audit policy &amp; scurity identifiers<br>\n_ SYSTEM: Configuration data for attached hardware devices &amp; system services<br>\n_ SOFTWARE: Cofniguration data for installed applications, including the Windows OS<br>\n_ DEFAULT: Default settings such as environment variables.<br>\nUsually overridden with user configuration data from the NTUSER hive so typically uninteresting","children":[],"payload":{"lines":"13,20"}}],"payload":{"lines":"12,13"}}],"payload":{"lines":"2,3"}},{"content":"Users Hives","children":[{"content":"Info","children":[{"content":"Store large amounts of configuration data for applications &amp; settings pertaining to each user account.<br>\nWe should expect find:<br>\n_ cloud storage settings<br>\n_ file &amp; folder interaction<br>\n_ application execution<br>\n_ internet activities","children":[],"payload":{"lines":"22,28"}},{"content":"\"Last Write Time\" is an important artifact.<br>\nIt is updated when a vuel is added, updated or deleted.<br>\nIt is stored in UTC time zone, always.","children":[],"payload":{"lines":"28,31"}},{"content":"RID (Relative IDentifier): SID is a unique value to represent an object in Active Directory.<br>\nRID is the incremental portion of the SID value. Once RID value is being used to generate a SID, it will not use again. Even after deleting an object from AD, it will not able to reclaim the RID value back.","children":[],"payload":{"lines":"31,33"}}],"payload":{"lines":"21,22"}},{"content":"Hunting","children":[{"content":"%UserProfile%\\NTUSER.DAT<br>\nThe most dominent user hive containing most relevant user-related data.","children":[],"payload":{"lines":"34,36"}},{"content":"%UserProfile%\\AppData\\Local\\Microsoft\\Windows\\UserClass.dat<br>\nSince Vista OS, serves as virtualized registry root in support of the UAC. Most important of these artifacts are Shellbags &amp; muicache","children":[],"payload":{"lines":"36,38"}}],"payload":{"lines":"33,34"}}],"payload":{"lines":"20,21"}},{"content":"Tool","children":[{"content":"Zimmerman's Tool - ReCmd","children":[],"payload":{"lines":"39,40"}},{"content":"Zimmerman's Tool - Registry Explorer","children":[],"payload":{"lines":"40,41"}}],"payload":{"lines":"38,39"}},{"content":"Links","children":[{"content":"<a href=\"https://learn.microsoft.com/en-us/windows/win32/sysinfo/registry-virtualization\">Registry Virtualization</a>","children":[],"payload":{"lines":"42,43"}},{"content":"<a href=\"https://www.vmray.com/poweliks-fileless-malware-analysis/\">Poweliks Malware</a>","children":[],"payload":{"lines":"43,44"}},{"content":"<a href=\"https://learn.microsoft.com/en-us/previous-versions/cc750583(v=technet.10)?redirectedfrom=MSDN\">Inside the Registry - Mark Russinovich</a>","children":[],"payload":{"lines":"44,45"}},{"content":"<a href=\"https://github.com/msuhanov/regf-samples/blob/master/8.1-unreconciled/Flush%20strategies%20in%20the%20Windows%20registry.md\">Flush strategies in the Windows regsitry</a>","children":[],"payload":{"lines":"45,46"}}],"payload":{"lines":"41,42"}}],"payload":{"lines":"1,2"}},{"content":"User/Group Information Analysis","children":[{"content":"Hives:<br>\n%Windir%\\System32\\Config\\SAM<br>\nSOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\ProfileList","children":[],"payload":{"lines":"47,50"}},{"content":"It contains only information on local users. Domain accounts are located in Domain Controller.<br>\nTimes in SAM are stored in UTC time zone<br>\nIf a \"Total Login\" == 0 and \"Last Login Time\" != null means the account is a cloud-based account.<br>\n<a href=\"https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-microsoft-accounts\">Microsoft Accounts (Windows 10)</a>","children":[],"payload":{"lines":"50,54"}}],"payload":{"lines":"46,47"}},{"content":"System Configuration Auditing","children":[{"content":"Identify Microsoft OS version + some info (installation date ie):<br>\nSOFTWARE\\Microsoft\\Windows NT\\CurrentVersion<br>\nSYSTEM\\Setup\\Source OS (Historical updates)","children":[],"payload":{"lines":"55,58"}},{"content":"Computer Name:<br>\nSYSTEM\\&lt;CurrentControlSet&gt;\\Control\\ComputerName\\ComputerName<br>\nFYI: identify the curentcontrol set by checking SYSTEM\\Select -&gt; Current","children":[],"payload":{"lines":"58,61"}},{"content":"System Time Zone:<br>\nSYSTEM\\CurrentControlSet\\Control\\TimeZoneInformation","children":[],"payload":{"lines":"61,63"}},{"content":"Network Interfaces:<br>\nSOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\NetworkCards<br>\nSYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters\\Interfaces","children":[],"payload":{"lines":"63,66"}},{"content":"Historical Network Connections:<br>\nSOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\NetworkList\\Signatures\\Managed<br>\nSOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\NetworkList\\Signatures\\Unmanaged","children":[],"payload":{"lines":"66,69"}},{"content":"Network Profiles - First &amp; Last Times Connected:<br>\nSOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\NetworkList\\Profiles (Win7+)<br>\nSOFTWARE\\Microsoft\\WZSVC\\Parameters\\Interfaces\\{GUID} (XP)<br>\n_NameType Value =   6 (0x06) = Wired<br>\n_NameType Value =  23 (0x17) = VPN<br>\n_NameType Value =  71 (0x47) = Wireless<br>\n_NameType Value = 243 (0xF3) = Mobile Broadband<br>\n_Category VAlue = 0 = Public network<br>\n_Category VAlue = 1 = Private network (home)<br>\n_Category VAlue = 2 = Domain (managed corporate network)","children":[],"payload":{"lines":"69,79"}},{"content":"CapabilityAccessManager<br>\nSOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore<br>\nNTUSER\\Software\\Microsoft\\Windows\\CurrentVersionCapabilityAccessManager\\ConsentStore<br>\nMay be interesting to identify a malware using WebCam,µphone, else","children":[],"payload":{"lines":"79,83"}},{"content":"Shutdown information<br>\nSYSTEM\\&lt;CurentControlSet&gt;\\Control\\Windows (Shutdown Time)<br>\nSYSTEM\\&lt;CurentControlSet&gt;\\Control\\Watchdog\\Display (Shutdown count - XP)","children":[],"payload":{"lines":"83,86"}}],"payload":{"lines":"54,55"}},{"content":"User Activity Analysis","children":[{"content":"Windows Search History - Search bar<br>\nNTUSER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\WordWheelQuery","children":[],"payload":{"lines":"87,89"}},{"content":"Windows Search History - Cortana<br>\n%UserProfile%\\AppData\\Local\\Packages\\Microsoft.Windows.Cortana_cw5n1h2txyewy\\LocalState\\DeviceSearchCache (win10 before build 1909)<br>\n%UserProfile%\\AppData\\Local\\Packages\\Microsoft.Windows.Search_cw5n1h2txyewy\\LocalState\\DeviceSearchCache (win10 build 1909+)<br>\n%UserProfile%\\AppData\\Local\\Packages\\MicrosoftWindows.Client.CBS_cw5n1h2txyewy\\LocalState\\DeviceSearchCache (win11)","children":[],"payload":{"lines":"89,93"}},{"content":"Typed Paths - Records path typed into explorer by the user<br>\nNTUSER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\typedPaths","children":[],"payload":{"lines":"93,95"}},{"content":"RecentDocs - Records folders, files/files types opened by user<br>\nNTUSER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RecentDocs","children":[],"payload":{"lines":"95,97"}},{"content":"Microsoft Office file MRU<br>\nNTUSER\\Software\\Microsoft\\Office\\&lt;VERSION&gt;\\&lt;APPNAME&gt;\\File MRU<br>\nVERSION = 10.0 -&gt; OfficeXP<br>\nVERSION = 11.0 -&gt; Office2003<br>\nVERSION = 12.0 -&gt; Office2007<br>\nVERSION = 14.0 -&gt; Office2010<br>\nVERSION = 15.0 -&gt; Office2013<br>\nNTUSER\\Software\\Microsoft\\Office\\&lt;VERSION&gt;\\&lt;APPNAME&gt;\\User MRU\\LiveID_####\\File MRU<br>\nNTUSER\\Software\\Microsoft\\Office\\&lt;VERSION&gt;\\&lt;APPNAME&gt;\\User MRU\\ADAL_####\\File MRU<br>\nVERSION = 16.0 -&gt; Office2016/2019/M365","children":[],"payload":{"lines":"97,107"}},{"content":"Trusted documents - (i.e: when user click on \"Enable Content\" in a excel macro)<br>\nNTUSER\\Software\\Microsoft\\Office\\&lt;VERSION&gt;\\&lt;APPNAME&gt;\\Security\\Trusted Documents\\TrustRecords","children":[],"payload":{"lines":"107,109"}},{"content":"Common Dialog Keys - Records location of last opened/saved files of specific types<br>\nNTUSER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComDlg32\\OpenSavePidlMRU<br>\nNTUSER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComDlg32\\LastVisitedPidlMRU<br>\nNTUSER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\ComDlg32\\LastVisitedPidlMRULegacy","children":[],"payload":{"lines":"109,113"}}],"payload":{"lines":"86,87"}}],"payload":{"lines":"0,1"}},{"content":"Application Execution","children":[{"content":"BAM/DAM (Background/Desktop Activity Moderator):<br>\nSYSTEM\\&lt;CurrentControlSet&gt;\\Services\\(dam|bam)\\State\\UserSettings\\{SID}  (Since Win10 build 1709)<br>\nProvides fullpath of of the executable file &amp; last execution date up to 1 week.","children":[],"payload":{"lines":"114,117"}},{"content":"Last command executed<br>\nNTUSER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RunMRU (command executed via taskbar)","children":[],"payload":{"lines":"117,119"}},{"content":"UserAssist<br>\nNTUSER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\UserAssist{GUID}\\Count<br>\nProvides ApplicationName, RunCount, FocusTime, LastRunTime","children":[],"payload":{"lines":"119,122"}},{"content":"Task Bar FeatureUsage<br>\nNTUSER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\FeatureUsage (Since Win10 1903)<br>\nProvides information on application execution, pinned applications, #times the application was put into focus.<br>\nInformation stays even after application removal.","children":[],"payload":{"lines":"122,126"}},{"content":"Prefetch<br>\nC:\\Windows\\Prefetch<br>\nProvides application execution data","children":[],"payload":{"lines":"126,129"}},{"content":"<a href=\"https://www.crowdstrike.com/en-us/blog/how-to-employ-featureusage-for-windows-10-taskbar-forensics/\">How to Employ FeatureUsage for Win10 Taskbar Forensic</a>","children":[],"payload":{"lines":"129,130"}},{"content":"<a href=\"https://learn.microsoft.com/en-us/windows/win32/shell/knownfolderid\">Microsoft docs - KNOWNFOLDERID</a>","children":[],"payload":{"lines":"130,131"}}],"payload":{"lines":"113,114"}},{"content":"Cloud Storage Forensics","children":[{"content":"Microsoft OneDrive (By default since Win8+)","children":[{"content":"Local Files","children":[{"content":"%UserProfile%\\OneDrive (default)<br>\nNTUSER\\Software\\Microsoft\\OneDrive\\Accounts\\Personal (if custom)","children":[],"payload":{"lines":"134,136"}}],"payload":{"lines":"133,134"}},{"content":"Metadata","children":[{"content":"%UserProfile%\\AppData\\Local\\Microsoft\\OneDrive\\logs\\Personal (exists only if OneDrive is enabled)<br>\n-&gt; SyncDiagnotics.log - may provide information on local &amp; cloud cloud files<br>\n-&gt; ObfuscationStringMap.txt - may provide filenames present in OneDrive<br>\n%UserProfile%\\AppData\\Local\\Microsoft\\OneDrive\\settings\\Personal","children":[],"payload":{"lines":"137,141"}}],"payload":{"lines":"136,137"}}],"payload":{"lines":"132,133"}},{"content":"Microsoft OneDrive for Business","children":[{"content":"Local Files","children":[{"content":"%UserProfile%\\OneDrive - &lt;CompanyName&gt; (default)<br>\nNTUSER\\Software\\Microsoft\\OneDrive\\Accounts\\Business1 (if custom)","children":[],"payload":{"lines":"143,145"}}],"payload":{"lines":"142,143"}},{"content":"Metadata","children":[{"content":"%UserProfile%\\AppData\\Local\\Microsoft\\OneDrive\\logs\\Business1<br>\n-&gt; SyncDiagnotics.log - may provide information on local &amp; cloud cloud files<br>\n-&gt; &lt;Usercid&gt;.dat - list of local &amp; cloud file names","children":[],"payload":{"lines":"146,149"}}],"payload":{"lines":"145,146"}},{"content":"Links","children":[{"content":"<a href=\"https://community.spiceworks.com/t/cloud-storage-services-who-claims-the-top-spot-among-microsoft-google-dropbox/970651\">Cloud Storage services</a><br>\n<a href=\"https://github.com/Beercow/OneDriveExplorer\">OneDriveExplorer</a><br>\n<a href=\"https://learn.microsoft.com/en-us/purview/audit-search?tabs=microsoft-purview-portal\">Search the audit log in Security &amp; Compliance Center</a>","children":[],"payload":{"lines":"150,153"}}],"payload":{"lines":"149,150"}}],"payload":{"lines":"141,142"}},{"content":"Google Drive","children":[{"content":"Local Files","children":[{"content":"NTUSER\\Software\\Google\\DriveFS\\Share - Contains the local drive letter used<br>\n%UserProfile%\\AppData\\Local\\Google\\DriveFS\\&lt;account identifier&gt;\\content_cache - Contains file cache","children":[],"payload":{"lines":"155,157"}}],"payload":{"lines":"154,155"}},{"content":"Metadata","children":[{"content":"%UserProfile%\\AppData\\Local\\Google\\DriveFS&lt;account identifier&gt;<br>\n-&gt; metadata_sqlite_db - contains a list of offline, cloud-only &amp; deleted files present","children":[],"payload":{"lines":"158,160"}}],"payload":{"lines":"157,158"}},{"content":"Links","children":[{"content":"<a href=\"https://protobuf.dev/\">Protocol Buffer</a>","children":[],"payload":{"lines":"161,162"}}],"payload":{"lines":"160,161"}}],"payload":{"lines":"153,154"}},{"content":"DropBox","children":[{"content":"Local Files","children":[{"content":"%UserProfile%\\Dropbox (default)<br>\n%UserProfile%\\Dropbox.dropbox.cache (up to 3 days of deleted &amp; staged files)","children":[],"payload":{"lines":"164,166"}}],"payload":{"lines":"163,164"}},{"content":"Metadata","children":[{"content":"%UserProfile%\\AppData\\Local\\Dropbox<br>\n-&gt; nucleus.sqlite3, sync_histor.db &amp; aggregation.dbx - provide usage data &amp; metadata for local, cloud &amp; deleted files","children":[],"payload":{"lines":"167,169"}}],"payload":{"lines":"166,167"}}],"payload":{"lines":"162,163"}}],"payload":{"lines":"131,132"}},{"content":"Shell Item Analysis","children":[{"content":"Recent Items LNK Files","children":[{"content":"Hunting","children":[{"content":"C:\\Users\\&lt;UserName&gt;\\AppData\\Roaming\\Microsoft\\Office\\Recent (Win7+)<br>\nC:\\Users\\&lt;UserName&gt;\\AppData\\Roaming\\Microsoft\\Windows\\Recent (Win7+)<br>\nC:\\Document and Sttings\\&lt;UserName&gt;\\Recent (WinXP)","children":[],"payload":{"lines":"172,175"}}],"payload":{"lines":"171,172"}},{"content":"Tool","children":[{"content":"<a href=\"https://ericzimmerman.github.io/#!index.md\">Eric Zimmerman's tool LECmd</a>","children":[],"payload":{"lines":"176,177"}}],"payload":{"lines":"175,176"}},{"content":"Links","children":[{"content":"<a href=\"https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-shllink/16cb4ca1-9339-4d0c-a68d-bf1d6cc0f943\">Shell link (LNK) binary file format</a><br>\n<a href=\"https://binaryforay.blogspot.com/2016/02/introducing-lecmd.html\">Introducing LECmd by Eric Zimmerman</a>","children":[],"payload":{"lines":"178,180"}}],"payload":{"lines":"177,178"}}],"payload":{"lines":"170,171"}},{"content":"Jump List Artifacts","children":[{"content":"Hunting","children":[{"content":"C:\\Users\\&lt;UserName&gt;\\AppData\\Roaming\\Microsoft\\Windows\\Recetn\\AutomaticDestinations<br>\nC:\\Users\\&lt;UserName&gt;\\AppData\\Roaming\\Microsoft\\Windows\\Recetn\\CustomDestinations","children":[],"payload":{"lines":"182,184"}}],"payload":{"lines":"181,182"}},{"content":"Tool","children":[{"content":"<a href=\"https://ericzimmerman.github.io/#!index.md\">Zimmerman's Tool JLECmd</a>","children":[],"payload":{"lines":"185,186"}}],"payload":{"lines":"184,185"}},{"content":"Links","children":[{"content":"<a href=\"https://learn.microsoft.com/en-gb/windows/win32/api/shobjidl_core/nn-shobjidl_core-icustomdestinationlist?redirectedfrom=MSDN\">CustomDestinationList interface - Microsoft</a><br>\n<a href=\"https://github.com/libyal/libolecf/blob/main/documentation/OLE%20Compound%20File%20format.asciidoc\">OLE Compound File</a><br>\n<a href=\"https://binaryforay.blogspot.com/2016/02/jump-lists-in-depth-understand-format.html\">Jump list in depth</a><br>\n<a href=\"https://learn.microsoft.com/en-gb/windows/win32/api/shobjidl_core/nn-shobjidl_core-icustomdestinationlist?redirectedfrom=MSDN\">ICustomDestinationList interface</a><br>\n<a href=\"https://www.hexacorn.com/blog/2013/04/30/jumplists-file-names-and-appid-calculator/\">JumpList files names &amp; AppID calculator</a><br>\n<a href=\"https://github.com/EricZimmerman/JumpList/blob/master/JumpList/Resources/AppIDs.txt\">Zimmerman's JumpList AppIDs.txt file</a><br>\n<a href=\"https://github.com/EricZimmerman/JumpList/blob/master/JumpList/Resources/AppIDs.txt\">Forensics Wiki Jump List ID</a><br>\n<a href=\"https://learn.microsoft.com/en-us/uwp/api/windows.ui.startscreen.jumplist?view=winrt-22000\">JumplList Class - Microsoft docs</a>","children":[],"payload":{"lines":"187,195"}}],"payload":{"lines":"186,187"}}],"payload":{"lines":"180,181"}},{"content":"ShellBags","children":[{"content":"Hunting","children":[{"content":"Win7+:<br>\nUSRCLASS.DAT\\Local Settings\\Software\\Microsoft\\Windows\\Shell\\BagMRU<br>\nUSRCLASS.DAT\\Local Settings\\Software\\Microsoft\\Windows\\Shell\\Bags<br>\nNTUSER.DAT\\Software\\Microsoft\\Windows\\Shell\\BagMRU<br>\nNTUSER.DAT\\Software\\Microsoft\\Windows\\Shell\\Bags","children":[],"payload":{"lines":"197,202"}},{"content":"WinXP:<br>\nNTUSER.DAT\\Software\\Microsoft\\Windows\\Shell\\BagMRU<br>\nNTUSER.DAT\\Software\\Microsoft\\Windows\\Shell\\Bags<br>\nNTUSER.DAT\\Software\\Microsoft\\Windows\\ShellNoRoam\\BagMRU<br>\nNTUSER.DAT\\Software\\Microsoft\\Windows\\ShellNoRoam\\Bags<br>\nNTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\StreamMRU","children":[],"payload":{"lines":"202,208"}}],"payload":{"lines":"196,197"}},{"content":"Links","children":[{"content":"<a href=\"https://www.sciencedirect.com/science/article/pii/S1742287609000413\">Using shellbag information to reconstruct user activities</a><br>\n<a href=\"https://df-stream.com/2019/10/shellbags-windows-10-feature-updates/\">Windows 10 Feature Updates</a><br>\n<a href=\"https://www.sans.org/white-papers/34545/\">Windows ShellBags Forensics</a><br>\n<a href=\"https://github.com/EricZimmerman/GuidMapping/blob/master/Resources/GuidToName.txt\">Zimmerman's GuidMapping Document</a>","children":[],"payload":{"lines":"209,213"}}],"payload":{"lines":"208,209"}},{"content":"Tools","children":[{"content":"<a href=\"https://ericzimmerman.github.io/#!index.md\">Zimmerman's SBECmd</a>","children":[],"payload":{"lines":"214,215"}}],"payload":{"lines":"213,214"}}],"payload":{"lines":"195,196"}}],"payload":{"lines":"169,170"}},{"content":"USB Device Analysis","children":[{"content":"Hunting","children":[{"content":"SYSTEM\\&lt;CurrentControlSet&gt;\\Enum\\HID<br>\nSYSTEM\\&lt;CurrentControlSet&gt;\\Enum\\USB<br>\nSYSTEM\\&lt;CurrentControlSet&gt;\\Enum\\USBSTOR<br>\nSYSTEM\\&lt;CurrentControlSet&gt;\\Enum\\SCSI<br>\nSOFTWARE\\Microsoft\\Windows Portabe Devices<br>\nSOFTWARE\\Microsoft\\Windows Search\\VolumeInfoCache (Win7+)<br>\nSYSTEM\\MountedDevices<br>\nNTUSER.DAT\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\MountPoints2","children":[],"payload":{"lines":"217,225"}},{"content":"Evtx<br>\n20001,20003 - Plug &amp; Play driver installe attemped (System log)<br>\n4663 - Attempt to access removal storage object (Security log)<br>\n4656 - Failure to access removal storage object (Security log)<br>\n6416 - A new external device was reconized on system (Security log)<br>\n1006 - Device connect/disconnect (Windows Partition/Diagnostic log)","children":[],"payload":{"lines":"225,231"}}],"payload":{"lines":"216,217"}},{"content":"Tools","children":[{"content":"<a href=\"https://ericzimmerman.github.io/#!index.md\">Zimmerman's RegExplorer</a><br>\n<a href=\"https://usbdetective.com/\">USB Detective Tool</a><br>\n<a href=\"https://github.com/woanware/usbdeviceforensics\">USBDeviceForensics Tool GitHub</a>","children":[],"payload":{"lines":"232,235"}}],"payload":{"lines":"231,232"}},{"content":"Links","children":[{"content":"<a href=\"https://www.youtube.com/watch?v=6xD1XYBArMY\">The rise of Evil HID devices</a><br>\n<a href=\"https://www.usb.org/document-library/hid-usage-tables-15\">HID usage Tables</a><br>\n<a href=\"https://www.circl.lu/pub/tr-52/\">CIRCL Forensic Analysis of an HID Attack</a><br>\n<a href=\"https://en.wikipedia.org/wiki/Media_Transfer_Protocol\">Media Transfert Protocol</a><br>\n<a href=\"https://www.linux-usb.org/usb.ids\">USB IDs Repository</a><br>\n<a href=\"https://devicehunt.com/\">Device Hunt</a><br>\n<a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/install/hardware-ids\">Harware ID - Microsoft Docs</a><br>\n<a href=\"https://windowsir.blogspot.com/2013/01/there-are-four-lights-usb-accessible.html\">Windows IR</a>","children":[],"payload":{"lines":"236,244"}}],"payload":{"lines":"235,236"}}],"payload":{"lines":"215,216"}},{"content":"Email Forensics","children":[{"content":"Host-Based Email forensics","children":[{"content":"µSoft Outlook","children":[{"content":"Hunting","children":[{"content":"%UserProfile%\\Documents\\Outlook (Default Storage)<br>\n%UserProfile%\\AppData\\Local\\Microsoft\\Outlook (Default Storage)<br>\nNTUSER\\Software\\Microsoft\\Office\\16.0\\Outlook\\Search (Identify other archives)<br>\n.OST (Office Outlook Data File): M365, Exchange, IMAP<br>\n.PST (Outlook Data File): POP accounts, archives, older installation<br>\n.NST (Outlook Group Storage File): Group convesations &amp; calendar<br>\n%UserProfile%\\AppData\\Local\\Microsoft\\Windows\\INetCache\\Content.Outlook (Outlook Attachment - Default)<br>\nNTUSER\\Sfotware\\Microsoft\\Office\\&lt;version&gt;\\Outlook\\Security (Outlook Attachment - Configuration)","children":[],"payload":{"lines":"248,256"}}],"payload":{"lines":"247,248"}},{"content":"Links","children":[{"content":"<a href=\"https://www.nirsoft.net/utils/mailpv.html\">NirSoft Mail Pass</a><br>\n<a href=\"https://learn.microsoft.com/en-us/openspecs/office_file_formats/ms-pst/141923d5-15ab-4ef1-a524-6dce75aae546?redirectedfrom=MSDN\">Outlook Personal Forlder</a><br>\n<a href=\"https://www.nucleustechnologies.com/pst-viewer.html\">Kernel PST viewer</a><br>\n<a href=\"https://www.nucleustechnologies.com/ost-viewer.html\">Kernel OST viewer</a><br>\n<a href=\"https://www.pstwalker.com/\">PST Walker - Email Recovery and Migration</a>","children":[],"payload":{"lines":"257,262"}}],"payload":{"lines":"256,257"}}],"payload":{"lines":"246,247"}}],"payload":{"lines":"245,246"}},{"content":"Server-Based Email forensics","children":[{"content":"µSoft Exchange","children":[{"content":"Hunting","children":[{"content":"<code>New-MailboxExportRequest -Mailbox &lt;mailbox&gt; -FilePAth \\\\PATH\\TO\\mailbox.pst</code> PowerShell command to export mail since Exchange 2010 SP1","children":[],"payload":{"lines":"265,266"}},{"content":"<code>New-MailboxExportRequest -Mailbox &lt;mailbox&gt; - ContentFilter {(body -like \"Something\") -and (Received -lt \"MM/DD/YYY\")} -FilePAth \\\\PATH\\TO\\mailbox.ps</code> Filter example","children":[],"payload":{"lines":"266,267"}}],"payload":{"lines":"264,265"}},{"content":"Links","children":[{"content":"<a href=\"https://learn.microsoft.com/en-us/previous-versions/office/exchange-server-2007/bb331964(v=exchg.80)?redirectedfrom=MSDN\">File Structure of Exchange Store</a><br>\n<a href=\"https://learn.microsoft.com/en-us/exchange/security-and-compliance/recoverable-items-folder/recoverable-items-folder\">Recoverable Items Folder</a><br>\n<a href=\"https://learn.microsoft.com/en-us/exchange/recipients-in-exchange-online/manage-user-mailboxes/change-deleted-item-retention\">Single Item Recovery in Exchange</a>","children":[],"payload":{"lines":"268,271"}}],"payload":{"lines":"267,268"}}],"payload":{"lines":"263,264"}},{"content":"µSoft 365","children":[{"content":"Hunting","children":[{"content":"<code>Search-UnifiedAuditLog -StartDate MM/DD/YYYY -EdnDate MM/DD/YYYY -UserIds &lt;user1, user2&gt; -Operations MailItemsAccessed</code> - Unified Audit Logs in µSoft 365","children":[],"payload":{"lines":"273,274"}}],"payload":{"lines":"272,273"}},{"content":"Links","children":[{"content":"<a href=\"https://learn.microsoft.com/en-gb/purview/ediscovery-content-search?redirectSourcePath=%252fen-us%252farticle%252fuse-content-search-in-your-ediscovery-workflow-55f31488-288a-473a-9b9e-831a11e3711a\">Use Content Search in your eDiscovery</a><br>\n<a href=\"https://learn.microsoft.com/en-us/exchange/policy-and-compliance/ediscovery/compliance-search?view=exchserver-2019&amp;redirectedfrom=MSDN\">Use Compliance Search to Search All Mailboxes in Exchange</a><br>\n<a href=\"https://learn.microsoft.com/en-gb/purview/ediscovery-content-search?redirectSourcePath=%252fen-us%252farticle%252frun-a-content-search-in-the-office-365-security-compliance-center-61852fd9-fe8a-4880-a339-cb19ed3bff4a#create\">Run a Content Search in µSoft 365 Security &amp; Compliance Center</a><br>\n<a href=\"https://learn.microsoft.com/en-gb/purview/ediscovery-export-search-results?redirectSourcePath=%252fen-us%252farticle%252fexport-content-search-results-from-the-office-365-security-compliance-center-ed48d448-3714-4c42-85f5-10f75f6a4278\">Export content Search Result from µSoft 365</a><br>\n<a href=\"https://learn.microsoft.com/en-ie/purview/audit-mailboxes#mailbox-auditing-actions\">µSoft 365 - Manage MailBox Auditing</a><br>\n<a href=\"https://learn.microsoft.com/en-us/defender-cloud-apps/anomaly-detection-policy\">Investigate an Activity in µSoft 365 Cloud App Security</a><br>\n<a href=\"https://learn.microsoft.com/en-us/powershell/module/exchange/search-unifiedauditlog?view=exchange-ps\">Search-UnifiedAuditLog (ExchangePowerShell)</a><br>\n<a href=\"https://github.com/PwC-IR/Office-365-Extractor\">Office 365 Extractor</a>","children":[],"payload":{"lines":"275,283"}}],"payload":{"lines":"274,275"}}],"payload":{"lines":"271,272"}}],"payload":{"lines":"262,263"}}],"payload":{"lines":"244,245"}},{"content":"Additional Windows Artifacts","children":[{"content":"Windows Search Database","children":[{"content":"C:\\ProgramData\\Microsoft\\Searech\\Data\\Application\\Windows\\Windwis.edb (Win7+ )<br>\nC:\\Documents and Settings\\All Users\\Application Data\\Microsoft\\Search\\Data\\Applications\\Windows\\Windiws.edb<br>\n<a href=\"https://learn.microsoft.com/en-us/troubleshoot/windows-client/shell-experience/windows-search-performance-issues\">Troubleshoot Windows Search performance - Microsocft docs</a><br>\n<a href=\"https://support.microsoft.com/en-us/windows/search-indexing-in-windows-faq-da061c83-af6b-095c-0f7a-4dfecda4d15a\">Search indexing in Windows 10: FAQ</a><br>\n<a href=\"https://devblogs.microsoft.com/windows-search-platform/configuration-and-settings/\">Configuration and Settings</a><br>\n<a href=\"https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/hh875546(v=ws.11)\">ESE NT Utilities</a><br>\n<a href=\"https://github.com/moaistory/WinSearchDBAnalyzer\">WinSearchDBAnalyzer 1/2</a><br>\n<a href=\"https://moaistory.blogspot.com/2018/10/winsearchdbanalyzer.html\">WinSearchDBAnalyzer 2/2</a>","children":[],"payload":{"lines":"285,293"}}],"payload":{"lines":"284,285"}},{"content":"Windows Search Gather Logs","children":[{"content":"C:\\ProgramData\\Microsoft\\Search\\Data\\Applicatinos\\Windows\\GatherLogs\\SystemIndex<br>\nEvidence of:<br>\nIntersting files<br>\nFile changes<br>\nDeleted or wiped files","children":[],"payload":{"lines":"294,299"}}],"payload":{"lines":"293,294"}},{"content":"Windows Thumbcache","children":[{"content":"C:\\Users\\&lt;UserName&gt;\\AppData\\Local\\Microsoft\\Windows\\Explorer<br>\n<a href=\"https://thumbcacheviewer.github.io/\">Thumbcache Viewer</a><br>\n<a href=\"https://thumbsviewer.github.io/\">Thumbs.db Viewer</a><br>\n<a href=\"https://www.swiftforensics.com/2012/06/windows-7-thumbcache-hash-algorithm.html\">Win7 Thumbcache hash algorithm</a>","children":[],"payload":{"lines":"300,304"}}],"payload":{"lines":"299,300"}},{"content":"RecycleBin forensics","children":[{"content":"C:$RECYCLE.BIN\\&lt;User SID&gt;$Ixxxxx (Win7+)<br>\nC:\\RECYCLER\\&lt;User SID&gt;\\INFO2 (WinXP)<br>\n<a href=\"https://ericzimmerman.github.io/#!index.md\">Zimmerman's RBCmd</a>","children":[],"payload":{"lines":"305,308"}}],"payload":{"lines":"304,305"}},{"content":"Win10+ Timeline details","children":[{"content":"C:\\Users\\&lt;UserName&gt;\\AppData\\Local\\ConnectedDevicesPlatform\\&lt;SomeThing&gt;\\ActivitiesCache.db<br>\nNTUSER.DAT\\Software\\Microsoft\\IdentityCRL\\UserExtendedProperties (Cross-referenced local account name &lt;-&gt; Microsoft Cloud Account)<br>\nLogs 30+ days of User Activity:<br>\nApp execution<br>\nFile opening<br>\nURL visited<br>\nTime Zones<br>\nUser removed items persist in the database<br>\nNTUSER.DAT/Software/Microsoft/Windows/CurrentVersion/TaskFlow/DeviceCache - List of assets timeline is synced with.<br>\nDeviceType:<br>\n1: XboxOne<br>\n6: Apple iPhone<br>\n7: Apple iPad<br>\n8: Android device<br>\n9: Windows 10 Desktop<br>\n11: Windows 10 Phone<br>\n12: Linux device<br>\n13: Windows IoT<br>\n14: Microsoft Surface Hub<br>\n15: Windows 10 Laptop<br>\n16: Windows Surface<br>\n<a href=\"https://cellebrite.com/en/exploring-the-windows-activity-timeline-part-1-the-high-points/\">Exploring the Windows activity Timeline (Part 1) - Vico Marziale</a><br>\n<a href=\"https://cellebrite.com/en/exploring-the-windows-activity-timeline-part-2-syncing-across-devices/\">Exploring the Windows activity Timeline (Part 2) - Vico Marziale</a><br>\n<a href=\"https://github.com/kacos2000/WindowsTimeline/blob/master/WinTimelineLocal.ps1\">Kacos2000 WinTimelineLocal.ps1 script</a><br>\n<a href=\"https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-cdp/f5a15c56-ac3a-48f9-8c51-07b2eadbe9b4\">Connected Devices Platform Protocol v3</a><br>\n<a href=\"https://ericzimmerman.github.io/#!index.md\">Zimmerman's WxTCmd.exe</a>","children":[],"payload":{"lines":"309,335"}}],"payload":{"lines":"308,309"}},{"content":"SRUM - System Resource Usage Monitoring","children":[{"content":"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SRUM\\Extensions<br>\nC:\\Windows\\System32\\SRU<br>\n<a href=\"https://www.nirsoft.net/utils/ese_database_view.html\">ESE Database View</a><br>\n<a href=\"https://www.nirsoft.net/utils/network_usage_view.html\">NirSoft Network Usage View</a><br>\n<a href=\"https://github.com/MarkBaggett/srum-dump\">SRUM_DUMP</a><br>\n<a href=\"https://github.com/devgc/SrumMonkey\">SrumMonkey</a><br>\n<a href=\"https://ericzimmerman.github.io/#!index.md\">Zimmerman's SrumECmd</a>","children":[],"payload":{"lines":"336,343"}}],"payload":{"lines":"335,336"}}],"payload":{"lines":"283,284"}},{"content":"Event Log Analysis","children":[{"content":"Microsoft Office OAlerts","children":[{"content":"OAlerts.evtx Code 300<br>\nIdentify file interaction and alerts generated by Microsoft Office.<br>\n<a href=\"https://bromiley.medium.com/oalerts-the-microsoft-office-event-log-ad164e1eec0f\">OAlerts - The Microsoft Office Event log</a>","children":[],"payload":{"lines":"345,348"}}],"payload":{"lines":"344,345"}},{"content":"Wireless Network Geolocation","children":[{"content":"Microsoft-Windows-WLAN-AutoConfig Operational.evtx<br>\n8001 - Sucessful connection to wireless network<br>\n8002 - Failed connection to wireless network<br>\n8003 - Disconnection from wieless network<br>\n11004 - Wireless security stopped<br>\n11005 - Wireless security succeeded","children":[],"payload":{"lines":"349,355"}}],"payload":{"lines":"348,349"}}],"payload":{"lines":"343,344"}},{"content":"Browser Forensics","children":[{"content":"Google Chrome","children":[{"content":"Info","children":[{"content":"%UserProfile%\\AppData\\Local\\Google\\Chrome\\User Data (Win7+)<br>\n%UserProfile%\\Local Settings\\Applicatin Data\\Google\\Chrome\\User Data(WinXP)","children":[],"payload":{"lines":"358,360"}},{"content":"Artifacts stored in the following formats:<br>\nSQLite (majority of artifacts)<br>\nJSON<br>\nSNSS (session saver files)","children":[],"payload":{"lines":"360,364"}}],"payload":{"lines":"357,358"}},{"content":"History","children":[{"content":"%UserProfile%\\AppData\\Local\\Google\\Chrome\\User Data\\&lt;Profile&gt;<br>\nHistory<br>\nArchived History<br>\nHistory Index YYYY-MM<br>\nTop sites","children":[],"payload":{"lines":"365,370"}}],"payload":{"lines":"364,365"}},{"content":"Cache","children":[{"content":"%UserProfile%\\AppData\\Local\\Google\\Chrome\\User Data\\&lt;Profile&gt;\\Cache<br>\nFilename<br>\nURL<br>\nContent Type<br>\nFile Size<br>\nLast Fetched Time<br>\nServer Time","children":[],"payload":{"lines":"371,378"}}],"payload":{"lines":"370,371"}},{"content":"Cookies","children":[{"content":"%UserProfile%\\AppData\\Local\\Google\\Chrome\\User Data\\&lt;Profile&gt;\\Network","children":[],"payload":{"lines":"379,380"}}],"payload":{"lines":"378,379"}},{"content":"HTML5 Web Storage","children":[{"content":"%UserProfile%\\AppData\\Local\\Google\\Chrome\\User Data\\&lt;Profile&gt;\\Local Storage\\","children":[],"payload":{"lines":"381,382"}}],"payload":{"lines":"380,381"}},{"content":"HTML5 FileSystem","children":[{"content":"%UserProfile%\\AppData\\Local\\Google\\Chrome\\User Data\\&lt;Profile&gt;\\File System<br>\nTo be used in conjunction with LevelDB database from \"Local Storage\" folder.<br>\nProvides correlation between information found in LevelDB and an artifact in the FS.","children":[],"payload":{"lines":"383,386"}}],"payload":{"lines":"382,383"}},{"content":"Shortcuts","children":[{"content":"%UserProfile%\\AppData\\Local\\Google\\Chrome\\User Data\\&lt;Profile&gt;<br>\nProvides information on browsed websites","children":[],"payload":{"lines":"387,389"}}],"payload":{"lines":"386,387"}},{"content":"Session Recovery","children":[{"content":"%UserProfile%\\AppData\\Local\\Google\\Chrome\\User Data\\&lt;Profile&gt;\\Sessions<br>\nProvides information on browsed websites","children":[],"payload":{"lines":"390,392"}}],"payload":{"lines":"389,390"}},{"content":"Chrome syncrhonization","children":[{"content":"History<br>\nOnly typed URLs<br>\nVisit count, typed count<br>\nVisit time<br>\nWeb Data<br>\nBookMarks<br>\nExtensions<br>\nLogin Data<br>\nTabs","children":[],"payload":{"lines":"393,402"}}],"payload":{"lines":"392,393"}}],"payload":{"lines":"356,357"}},{"content":"Microsoft Edge","children":[{"content":"%UserProfile%\\AppData\\Local\\Microsoft\\edge\\User Data\\&lt;Profile&gt;<br>\nAs Edged is Chromium based, most artifacts are similar.<br>\nFew differences exist, not described here.","children":[],"payload":{"lines":"403,406"}}],"payload":{"lines":"402,403"}},{"content":"Mozilla Firefox","children":[{"content":"%UserProfile%\\AppData\\Roaming\\Mozilla\\Firefox\\Profiles\\&lt;random text&gt;.default ( History, Cookies, Bookmarks, AutoCompletion)","children":[],"payload":{"lines":"407,408"}},{"content":"%UserProfile%\\AppData\\Local\\Mozilla\\Firefox\\Profiles\\&lt;random text&gt;.default\\Cache - Cache<br>\nSQLite format","children":[],"payload":{"lines":"408,410"}}],"payload":{"lines":"406,407"}},{"content":"Links","children":[{"content":"<a href=\"https://kb.digital-detective.net/display/BF/Page+Transitions\">Page Transition</a>","children":[],"payload":{"lines":"411,412"}},{"content":"<a href=\"https://dfir.blog/deciphering-browser-hieroglyphics-leveldb-filesystem/\">Deciphering Browser Hieroglyphics</a>","children":[],"payload":{"lines":"412,413"}}],"payload":{"lines":"410,411"}},{"content":"Tools","children":[{"content":"<a href=\"https://www.nirsoft.net/utils/chrome_cache_view.html\">NirSoft ChromeChacheView</a>","children":[],"payload":{"lines":"414,415"}},{"content":"<a href=\"https://github.com/markmckinnon/Leveldb-py\">LevelDB-py</a>","children":[],"payload":{"lines":"415,416"}},{"content":"<a href=\"https://github.com/rdreher/chromeStorageDump\">ChromeStorageDump</a>","children":[],"payload":{"lines":"416,417"}},{"content":"<a href=\"https://github.com/obsidianforensics/hindsight\">Hindsights !!!</a>","children":[],"payload":{"lines":"417,418"}},{"content":"<a href=\"https://www.nirsoft.net/utils/mozilla_cache_viewer.html\">Nirsoft MZCacheView</a>","children":[],"payload":{"lines":"418,419"}}],"payload":{"lines":"413,414"}}],"payload":{"lines":"355,356"}}]},{"colorFreezeLevel":2,"initialExpandLevel":2})</script>
</body>
</html>
